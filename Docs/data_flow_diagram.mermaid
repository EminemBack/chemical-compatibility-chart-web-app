flowchart TD
    START([ğŸ‘¤ User Opens App]) --> LOAD[ğŸ“‹ Load GHS Categories<br/>GET /ghs-categories/]
    
    LOAD --> FORM{ğŸ“ Fill Container Form}
    FORM --> DEPT[ğŸ¢ Enter Department]
    FORM --> LOC[ğŸ“ Enter Location]
    FORM --> CONT[ğŸ“¦ Enter Container ID]
    FORM --> TYPE[ğŸ“ Select Type: 20ft/40ft]
    FORM --> USER[ğŸ‘¨â€ğŸ’¼ Enter Submitted By]
    
    DEPT --> SELECT
    LOC --> SELECT
    CONT --> SELECT
    TYPE --> SELECT
    USER --> SELECT[ğŸ§ª Select GHS Hazards<br/>Visual Grid Interface]
    
    SELECT --> SINGLE{Single Hazard?}
    
    SINGLE -->|Yes| SUBMIT_SINGLE[âœ… Submit Single Hazard<br/>POST /containers/]
    SINGLE -->|No| PAIRS[ğŸ”„ Auto-Generate Pairs<br/>Frontend Logic]
    
    PAIRS --> PREVIEW[ğŸ‘ï¸ Real-time Preview<br/>POST /preview-status/]
    PREVIEW --> DISTANCE[ğŸ“ Enter Distances<br/>Live Status Updates]
    
    DISTANCE --> STATUS{Check Status}
    STATUS --> SAFE[ğŸŸ¢ SAFE<br/>Green Background]
    STATUS --> CAUTION[ğŸŸ¡ CAUTION<br/>Yellow Background]
    STATUS --> DANGER[ğŸ”´ DANGER<br/>Red Background]
    
    SAFE --> SUBMIT
    CAUTION --> SUBMIT
    DANGER --> SUBMIT[ğŸ“¤ Submit Assessment<br/>POST /containers/]
    
    SUBMIT_SINGLE --> SAVE
    SUBMIT --> SAVE[(ğŸ’¾ Save to Database<br/>4 Tables Updated)]
    
    SAVE --> SUCCESS[âœ… Success Message<br/>Container ID Returned]
    SUCCESS --> VIEW[ğŸ‘€ View Assessments<br/>GET /containers/]
    
    VIEW --> DISPLAY[ğŸ“Š Display Results<br/>Color-coded Matrix]
    DISPLAY --> HISTORY[ğŸ“š Assessment History<br/>Full Audit Trail]
    
    %% Error Handling
    FORM --> ERROR1{âŒ Validation Error?}
    ERROR1 -->|Yes| ALERT1[âš ï¸ Show Error Message]
    ALERT1 --> FORM
    
    SUBMIT --> ERROR2{âŒ Server Error?}
    ERROR2 -->|Yes| ALERT2[âš ï¸ Show Error Message]
    ALERT2 --> DISTANCE
    
    %% Reset Flow
    DISTANCE --> RESET[ğŸ”„ Reset Form?]
    RESET -->|Yes| FORM
    
    %% Styling
    classDef user fill:#D4A553,stroke:#1E3A5F,stroke-width:2px,color:#fff
    classDef process fill:#1E3A5F,stroke:#D4A553,stroke-width:2px,color:#fff
    classDef decision fill:#FF8F00,stroke:#1E3A5F,stroke-width:2px,color:#fff
    classDef status fill:#2E7D32,stroke:#1E3A5F,stroke-width:2px,color:#fff
    classDef error fill:#C62828,stroke:#1E3A5F,stroke-width:2px,color:#fff
    
    class START,USER,DEPT,LOC,CONT,TYPE user
    class LOAD,SELECT,PAIRS,PREVIEW,DISTANCE,SUBMIT,SAVE,DISPLAY process
    class FORM,SINGLE,STATUS,ERROR1,ERROR2 decision
    class SAFE,CAUTION,DANGER,SUCCESS status
    class ALERT1,ALERT2 error